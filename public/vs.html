<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meltian fire it!</title>
  <link rel="stylesheet" href="vs.css">
  <script src="https://unpkg.com/alpinejs" defer></script>
</head>

<body>
  <div>
    <div class="backgraund1">
      <a href="home.html"><img src="image/dialog.png" width="30px" height="30px" alt="sample"></a>
    </div>
    <div class="background2" >
      <div id="life-frame">
        <div id="life-bar"></div>
        <div id="life-mark"></div>
      </div>
      <div class="enemy_name" id="enemy_name" >
        <b>
          雑魚クーラン
        </b>
      </div>
      <div class="vs">
        <div class="enemy" style="text-align: center">
          <img id="image01" src="image/snowman1.png" width="70%" alt="sample">
        </div>
      </div>
      <div class="position">
          <img id="image02" src="image/gauge.png" width="40%" alt="sample">
          <img id="image03" src="image/gauge1.png" width="40%" alt="sample">

          <div class="meters-wrapper">
            <div class="meter-panel">
              <div class="meter">
                <div class="power">
                  <img id="needle02" src="image/needle2.png" class="needle" width="90px" style="transform: scale(-1, 1);">
                </div>
              </div>
            </div>
          </div>

          <div class="meters-wrapper">
            <div class="meter-panel">
              <div class="meter">
                <div class="power">
                  <img id="needle03" src="image/needle2.png" class="needle" width="90px" style="transform: scale(-1, 1);">
                </div>
              </div>
            </div>
          </div>
      </div>
      <div class="position" >
        <div class="button1">
          <input type="image" id="button01" src="image/atk_button.png" onclick="countUpA()" width="100%" height="100%" alt="HPmeter">
        </div>
        <div class="button2" >
            <input type="image" id="button02" src="image/run_button.png"  onclick="countreset()" width="100%" height="100%" alt="POWERmeter">
        </div>
      </div>
      <div id="text" class="box">
        <div>
            雑魚クーランが現れた！
        </div>
      </div>
    </div>
  </div>
  
</body>
<script type="text/javascript" >
  var elem = 0
  const lifeBar = document.getElementById('life-bar')         
  const lifeMark = document.getElementById('life-mark')       
  let maxlife_enemy = 273*3
  let life_enemy = maxlife_enemy              
  let atk_enemy = 273
  let atk = 273
  let maxhp = 273*3
  let hp = maxhp
  let atkGauge=70
  const dec_atkGauge=20
  lifeBar.style.width = "100%"    
  document.getElementById("needle02").style.transform=`rotate(${Math.floor(180 * (hp / maxhp))}deg)`;
  document.getElementById("needle03").style.transform=`rotate(${Math.floor(180 * (atkGauge / 100))}deg)`;
  let obj = document.getElementById('text')
  function countUpA(){
    document.getElementById("image01").innerHTML = ++elem;
    life_enemy-=atk;
    atkGauge-=dec_atkGauge;
    hp-=atk_enemy;
    const lifePercentage_enemy=life_enemy/maxlife_enemy
    if(life_enemy<0) life_enemy=0
    switch (elem){
      case 0:
        document.getElementById("image01").src="image/snowman1.png";
        break;
      case 1:
      setTimeout(function(){
        document.getElementById('text').innerText = "攻撃をした!";
        document.getElementById("button01").disabled = true;
        document.getElementById("button02").disabled = true;
        document.getElementById("image03").style.filter="opacity(0.4) drop-shadow(0 0 0 blue)";
        }, 1)
        setTimeout(function(){
          document.getElementById("image01").src="image/snowman4.png";
          document.getElementById("needle03").style.transform=`rotate(${Math.floor(180 * (atkGauge / 100))}deg)`;
          document.getElementById("image03").style.filter="none";
        }, 250) 
        setTimeout(function(){
          lifeBar.style.width = `${lifePercentage_enemy}`;
        }, 500) 
        setTimeout(function(){
          document.getElementById('text').innerText = `${atk}kのダメージを与えた!`;
          document.getElementById("image01").src="image/snowman2.png";
        }, 1000) 
        setTimeout(function(){
          document.getElementById('text').innerText = "クーランが攻撃してきた!";
        }, 2000) 
        setTimeout(function(){
          document.getElementById("image02").style.filter="opacity(0.4) drop-shadow(0 0 0 red)";
        }, 2250) 
        setTimeout(function(){
          document.getElementById("needle02").style.transform=`rotate(${Math.floor(180 * (hp / maxhp))}deg)`;
          document.getElementById("image02").style.filter="none";
          document.getElementById('text').innerText = `${atk_enemy}Kのダメージを受けた!`;
          document.getElementById("button02").disabled = false;
          document.getElementById("button01").disabled = false;
        }, 3000) 
        break;
      case 2:
      setTimeout(function(){
        document.getElementById('text').innerText = "攻撃をした!";
        document.getElementById("button01").disabled = true;
        document.getElementById("button02").disabled = true;
        document.getElementById("image03").style.filter="opacity(0.4) drop-shadow(0 0 0 blue)";
        }, 1)
        setTimeout(function(){
          document.getElementById("image01").src="image/snowman5.png";
          document.getElementById("needle03").style.transform=`rotate(${Math.floor(180 * (atkGauge / 100))}deg)`;
          document.getElementById("image03").style.filter="none";
        }, 250) 
        setTimeout(function(){
          lifeBar.style.width = `${lifePercentage_enemy}`;  
        }, 500) 
        setTimeout(function(){
          document.getElementById('text').innerText = `${atk}kのダメージを与えた!`;
          document.getElementById("image01").src="image/snowman3.png";
        }, 1000) 
        setTimeout(function(){
          document.getElementById('text').innerText = "クーランが攻撃してきた!";
        }, 2000) 
        setTimeout(function(){
          document.getElementById("image02").style.filter="opacity(0.4) drop-shadow(0 0 0 red)";
        }, 2250) 
        setTimeout(function(){
          document.getElementById("needle02").style.transform=`rotate(${Math.floor(180 * (hp / maxhp))}deg)`;
          document.getElementById("image02").style.filter="none";
          document.getElementById('text').innerText = `${atk_enemy}Kのダメージを受けた!`;
          document.getElementById("button02").disabled = false;
          document.getElementById("button01").disabled = false;
        }, 3000) 
        break;
      case 3:
        setTimeout(function(){
        document.getElementById("image03").style.filter="opacity(0.4) drop-shadow(0 0 0 blue)";
          document.getElementById('text').innerText = "攻撃をした!";
          document.getElementById("button01").disabled = true;
          document.getElementById("button02").disabled = true;
        }, 1) 
        setTimeout(function(){
          document.getElementById("needle03").style.transform=`rotate(${Math.floor(180 * (atkGauge / 100))}deg)`;
          document.getElementById("image03").style.filter="none";
          document.getElementById("image01").src="image/snowman6.png";
          lifeBar.style.width = `${lifePercentage_enemy}`;   
          document.getElementById('text').innerText = "敵を討伐した！";
        }, 1000) 
        setTimeout(function(){
          document.getElementById("enemy_name").style.visibility = 'hidden';
          document.getElementById("life-frame").style.visibility = 'hidden';
          document.getElementById("image01").style.visibility = 'hidden';
          document.getElementById('text').innerText = "おめでとう！君の勝利！";
        }, 2000) 
        setTimeout(function(){
          document.getElementById("enemy_name").style.visibility='visible';
          document.getElementById("image01").style.visibility='visible';
          document.getElementById("life-frame").style.visibility='visible';
          document.getElementById('text').innerText = "新たな雑魚クーランが現れた！";
          document.getElementById("image01").src="image/snowman1.png";
          document.getElementById("needle02").style.transform=`rotate(${Math.floor(180 * (hp / maxhp))}deg)`;
          document.getElementById("needle03").style.transform=`rotate(${Math.floor(180 * (atkGauge / 100))}deg)`;
          lifeBar.style.width = "100%";
          elem=0;
          life_enemy=maxlife_enemy;
          atkGauge=70
          hp=maxhp
          document.getElementById("button02").disabled = false;
          document.getElementById("button01").disabled = false;
        }, 6000) 
        break;
    }
  }
  function countreset(){
    document.getElementById("button01").disabled = true;
    document.getElementById("button02").disabled = true;
    document.getElementById('text').innerText = "逃げ出した！";
    document.getElementById("enemy_name").style.visibility = 'hidden';
    document.getElementById("life-frame").style.visibility = 'hidden';
    document.getElementById("image01").style.visibility = 'hidden';
    setTimeout(function(){
      lifeBar.style.width = "100%"    
      elem=0;
      document.getElementById("enemy_name").style.visibility='visible';
      document.getElementById("image01").style.visibility='visible';
      document.getElementById("life-frame").style.visibility='visible';
      document.getElementById('text').innerText = "新たな雑魚クーランが現れた！";
      document.getElementById("image01").src="image/snowman1.png";
      document.getElementById("image03").src="image/gauge/pwgauge70.png";
      document.getElementById("image02").src="image/gauge/hpgauge100.png";
      document.getElementById("button02").disabled = false;
      document.getElementById("button01").disabled = false;
    }, 3000) 
    
    
  }
</script>
</html>